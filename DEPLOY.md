# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é Stvor –Ω–∞ VDS —Å–µ—Ä–≤–µ—Ä

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

–ù–∞ VDS —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
- **Docker** –∏ **Docker Compose**
- **Git**

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install -y docker.io docker-compose git
sudo systemctl start docker
sudo systemctl enable docker
sudo usermod -aG docker $USER
# –ü–µ—Ä–µ–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É docker
```

### 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
cd /var/www  # –∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
git clone https://github.com/your-username/stvorchat.git
cd stvorchat
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cp .env.example .env
nano .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
POSTGRES_USER=stvar
POSTGRES_PASSWORD=strong_password_here
POSTGRES_DB=stvar

# JWT
JWT_SECRET=very_strong_secret_key_here
JWT_EXPIRES_IN=7d

# API
PORT=4000
CLIENT_ORIGIN=http://your-domain.com

# Frontend (–¥–ª—è —Å–±–æ—Ä–∫–∏)
VITE_API_URL=http://your-domain.com:4000
VITE_SOCKET_URL=http://your-domain.com:4000

# HTTP –ø–æ—Ä—Ç (–¥–ª—è nginx)
HTTP_PORT=80
```

### 4. –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
chmod +x deploy.sh
./deploy.sh production
```

–í—Å—ë! –ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—â–µ–Ω. API –±—É–¥–µ—Ç –Ω–∞ `http://your-server:4000`, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ `http://your-server:80`.

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Secrets and variables ‚Üí Actions
2. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã:

- `SSH_PRIVATE_KEY` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
- `SSH_USER` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `root` –∏–ª–∏ `ubuntu`)
- `SSH_HOST` ‚Äî IP –∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞
- `DEPLOY_PATH` ‚Äî –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/var/www/stvorchat`)

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–∞

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
ssh-keygen -t ed25519 -C "deploy@stvor"
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –≤ GitHub Secrets (SSH_PRIVATE_KEY)
# –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤—å—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
ssh-copy-id user@your-server
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º `git push` –≤ `main` –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!

---

## –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh user@your-server
cd /var/www/stvorchat
git pull origin main
```

### 2. –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è

```bash
./deploy.sh production
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
docker compose -f docker-compose.prod.yml logs -f
# –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:
docker compose -f docker-compose.prod.yml logs -f server
docker compose -f docker-compose.prod.yml logs -f client
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
docker compose -f docker-compose.prod.yml down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫

```bash
docker compose -f docker-compose.prod.yml restart
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
docker compose -f docker-compose.prod.yml up --build -d
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
docker compose -f docker-compose.prod.yml exec server npx prisma migrate deploy
```

### –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
docker compose -f docker-compose.prod.yml exec db psql -U stvar -d stvar
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ –∏ SSL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –° Nginx –∫–∞–∫ reverse proxy

–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `/etc/nginx/sites-available/stvor`:

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /api {
        proxy_pass http://localhost:4000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
    }

    location /socket.io {
        proxy_pass http://localhost:4000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}
```

```bash
sudo ln -s /etc/nginx/sites-available/stvor /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### SSL —á–µ—Ä–µ–∑ Let's Encrypt

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose -f docker-compose.prod.yml logs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker compose -f docker-compose.prod.yml ps
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ë–î –∑–∞–ø—É—â–µ–Ω
docker compose -f docker-compose.prod.yml ps db

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ë–î
docker compose -f docker-compose.prod.yml logs db
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç

```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ø–æ—Ä—Ç
sudo netstat -tlnp | grep :80
sudo netstat -tlnp | grep :4000

# –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ .env –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å
```

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /var/www/stvorchat
git pull
./deploy.sh production
```

–ò–ª–∏ —á–µ—Ä–µ–∑ GitHub Actions (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ push).

---

–ì–æ—Ç–æ–≤–æ! üéâ –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –µ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

